<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Transitional//EN" "http://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd">
<%@ page language="java" contentType="text/html; charset=UTF-8"   pageEncoding="UTF-8"%>
<%@ include file="/pages/sso/top.jsp" %>
${jquery_js}                          
${jquery_form_js} 

    <!--中间开始--> 
       <table width="950" border="0" align="center" cellpadding="0"
						cellspacing="0">
						<tr>
						  <td width="248" height="572" valign="top">
							<table class="bea-portal-window-titlebar-container" width="94%" border="0" cellspacing="0" cellpadding="0" style="margin-top: 5px;">
                                    <tr>
                                     <td align="left" class="bea-portal-window-title-left" >&nbsp;</td>
                    
                                        <td class="bea-portal-window-titlebar-title" >用户信息</td>           
                                        <td class="bea-portal-window-titlebar-buttons"></td>
                                        <td class="bea-portal-window-title-right" width="7"></td>
                                    </tr>
							</table>
								<table  class="bea-portal-window-content" width="100%" border="0" cellspacing="0" cellpadding="0">
									<tr>
										<td >
											<TABLE cellSpacing=0 cellPadding=0 width=100%  height="154" border=0 class=tabstyle >
                                                <tr><td align="center" height='20'>欢迎您：检查</td></tr>
                                                <tr><td align="center" height='19'>科技信通部（智能电网办公室）</td></tr>
                                                <tr><td align="center" height='19'>本月共登录：<font color="red">29</font>次</td></tr>
                                                
                                                <tr>
                                                  <td align="center">
                                                    <table width=95% cellSpacing=0 cellPadding=0>
                                                      <tr class=tab-even>
                                                        <td width=20></td>
                                                        <td class="info-arrow">&nbsp;</td>
                                                        <td align="left"><a href="javascript:openXX(1)">密码修改</a></td>
                                                        <td class="info-arrow">&nbsp;</td>
                                                        <td align="left"><a href="javascript:openXX(2)">短信定制</a></td>
                                                      </tr>
                                                      <tr class=tab-add>
                                                        <td width=20></td>
                                                        <td class="info-arrow">&nbsp;</td>
                                                        <td align="left"><a href="javascript:openXX(3)">定制风格</a></td>
                                                        <td class="info-arrow">&nbsp;</td>
                                                        <td align="left"><a href="javascript:openXX(4)">定制内容</a></td>
                                                      </tr>
                                                      <tr class=tab-even>
                                                        <td width=20></td>
                                                        <td class="info-arrow">&nbsp;</td>
                                                        <td align="left"><a href="javascript:openXX(5)">初始布局</a></td>
                                                        <td class="info-arrow">&nbsp;</td>
                                                        <td align="left"><a href="javascript:guanbi()">退出门户</a></td>
                                                      </tr>
                                                      <tr class=tab-add>
                                                        <td colspan="5"></td>
                                                      </tr>
                                                    </table>
                                                  </td>
                                                </tr>
                                          </table> 
										</td>
									</tr>
							  </table>
							<table class="bea-portal-window-titlebar-container" width="94%" border="0" cellspacing="0" cellpadding="0" style="margin-top: 5px;">
									<tr>
                                     <td align="left" class="bea-portal-window-title-left" >&nbsp;</td>
                    
                                      <td class="bea-portal-window-titlebar-title" >最新公告</td>           
                                        <td class="bea-portal-window-titlebar-buttons"></td>
                                        <td class="bea-portal-window-title-right" width="7"></td>
                                    </tr>
							</table>
                                <table  class="bea-portal-window-content" width="100%" border="0" cellspacing="0" cellpadding="0">
                                  <tr>
                                    <td ><table cellspacing=0 cellpadding=0 width=100%  height="154" border=0 style="margin-left: 2px;">
                                        <tr>
                                          <td height="20"> · <a href="#" class="anav">关于办理电费银行代扣业务的示</a> </td>
                                        </tr>
                                        <tr>
                                          <td height="20"> · <a href="#" class="anav">移动电计量装置安装位置</a> </td>
                                        </tr>
                                        <tr>
                                          <td height="20"> · <a href="#" class="anav">电费交费常识问答</a> </td>
                                        </tr>
                                        <tr>
                                          <td height="20"> · <a href="#" class="anav">关于办理电费银行代扣业务的示</a> </td>
                                        </tr>
                                        <tr>
                                          <td height="20"> · <a href="#" class="anav">移动电计量装置安装位置</a> </td>
                                        </tr>
                                        <tr>
                                          <td height="20"> · <a href="#" class="anav">移动电计量装置安装位置</a> </td>
                                        </tr>
                                    </table>
										</td>
									</tr>
							</table>
					        <table class="bea-portal-window-titlebar-container" width="94%" border="0" cellspacing="0" cellpadding="0" style="margin-top: 5px;">
									<tr>
                                     <td align="left" class="bea-portal-window-title-left" >&nbsp;</td>
                    
                                      <td class="bea-portal-window-titlebar-title" >日历</td>           
                                        <td class="bea-portal-window-titlebar-buttons"></td>
                                        <td class="bea-portal-window-title-right" width="7"></td>
                                    </tr>
							</table>
                                <table  class="bea-portal-window-content" width="100%" border="0" cellspacing="0" cellpadding="0">
                                  <tr>
                                    <td ><table cellspacing=0 cellpadding=0 width=100%  height="174" border=0 style="margin-left: 2px;">
                                        <tr>
                                          <td height="20"> · <a href="#" class="anav">关于办理电费银行代扣业务的示</a> </td>
                                        </tr>
                                        <tr>
                                          <td height="20"> · <a href="#" class="anav">移动电计量装置安装位置</a> </td>
                                        </tr>
                                        <tr>
                                          <td height="20"> · <a href="#" class="anav">电费交费常识问答</a> </td>
                                        </tr>
                                        <tr>
                                          <td height="20"> · <a href="#" class="anav">关于办理电费银行代扣业务的示</a> </td>
                                        </tr>
                                        <tr>
                                          <td height="20"> · <a href="#" class="anav">移动电计量装置安装位置</a> </td>
                                        </tr>
                                        <tr>
                                          <td height="20"> · <a href="#" class="anav">移动电计量装置安装位置</a> </td>
                                        </tr>
                                    </table>
										</td>
									</tr>
							</table>
						  </td>
                            <td width="1%"></td>
							<td width="754" valign="top" height="550">
									<table class="bea-portal-window-titlebar-container" cellspacing="0" cellpadding="0" width="100%" style="margin-top: 5px;">
                                    <tr >
                                      <td align="left" class="bea-portal-window-title-left" >&nbsp;</td>
                    
                                        <td class="bea-portal-window-titlebar-title" >我的系统</td>           
                                        <td class="bea-portal-window-titlebar-buttons"></td>
                                        <td class="bea-portal-window-title-right" width="7"></td>
                                    </tr>
                                </table>
                                
                                
                                
                                
                                <%--我的系统信息 --%>
								<table  class="bea-portal-window-content" width="100%" border="0" cellspacing="0" cellpadding="0">
									<tr>
										<td>
										
											<!--<TABLE cellSpacing=0 cellPadding=0 width=100%  height="540" border=0 class=tabstyle >-->
                                            <%-- 展示系统列表--%>
                                            <table width="98%" height="540" border="0" cellspacing="0" cellpadding="0" align=center class="mhjl-style" style="margin:0px;">
                                              
                                              <%--展示代码 --%>
                                              <c:if test="${not empty mySystemLoginLst }">
 												 <c:forEach var="sys" items="${mySystemLoginLst}" varStatus="status">
 									 
 											   <%--判断基数或者偶数 --%>
 											   <c:if test="${status.index%4==0&&(status.index/4)%2==0}">
 											    <tr class=tab-add height="40">
 											   </c:if> 
 											   <c:if test="${status.index%4==0&&(status.index/4)%2==1}">
 											    <tr class=tab-even height="40">
 											   </c:if>
 											   
											   <td>
											    <a href="#" onclick="getUserLoginInfo('${sys.appId}','${userName}','${sys.account_Column_Name}','${sys.user_Name_Cfg}','${sys.password_Cfg}','${password}','${sys.form_action_url}','${sys.configId}');">
											     ${sys.appname}  
											    </a>
											   </td>
											   
											   <c:if test=" ${status.index%4==0}">
 											      </tr>
 											   </c:if>
											   
											  </c:forEach>
											  </c:if>
											  
                                              </table> 
									</tr>
								</table> 
							</td>
						</tr>
					</table>
    <!--中间结束-->
   
<%--生成表单 --%>
<form name="ssoFrm" id="ssoFrm" method="post" target="_blank">
 
</form>

   
   
   
   <%@ include file="/pages/sso/bottom.jsp" %>
   
   
</div>






</body>
</center>
</html>





<script>

/**
 *  * 获取此系统，此用户的登录信息，动态生成表单元素
 *     从而进行登录操作
 *      appId:应用的ID,userAccount:门户登录名
 *      accountColumnName：在t_idm_user表中的业务系统对应的用户账号字段名
 *      userNameCfg：用户参数名      passwordCfg：密码参数名
 *      passwordValue：密码的值
 *
 */
function getUserLoginInfo(appId,userAccount,accountColumnName,userNameCfg,passwordCfg,passwordValue,appLoginUrl,configId){
	//alert(appId+","+userAccount+","+accountColumnName+","+userNameCfg+","+passwordCfg+","+passwordValue+","+appLoginUrl);
	alert(configId);
	
	var columnNameValue="";
	//
    $.post(
            "${ctx}/sso/getUserLoginInfo.action",
            {
                "appId":appId,
                "accountColumnName":accountColumnName,
                "userAccount":userAccount,
                "password":passwordValue,
                "formatter":'',
                "configId":configId
            },
            function (data, textStatus) {
                if (textStatus == "success") {
                    if (data.result) {
                    	alert(data.password);
                    	//alert("columnNameValue:"+data.columnNameValue);
                    	columnNameValue=data.columnNameValue;
                    	//alert(userNameCfg);
                    	//创建input:text
                        $('<input />',{ 
                        type:"text", 
                        val:columnNameValue, 
                        name:userNameCfg 
                        }).appendTo("#ssoFrm"); 
                    	
                        $('<input />',{ 
                            type:"text", 
                            val:data.password, 
                            name:passwordCfg
                            }).appendTo("#ssoFrm"); 
                        
                        $("#ssoFrm").attr("action",appLoginUrl);
                        $("#ssoFrm").submit();
                    }
                    else {
                    	alert("msg:"+data.msg);
                    }
                } else {
                   alert("请求异常!");
                }
            },
            "json"
	);
	
	
	
  //创建input:text 
}



</script>
